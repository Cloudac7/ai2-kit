

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>CLL Machine Learning Potential Training Workflow &#8212; ai2-kit Reference</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'doc/manual/cll-workflow';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="FEP MLP Training Workflow" href="fep-workflow.html" />
    <link rel="prev" title="ai2-cat Toolkit" href="ai2cat.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">ai2-kit Reference</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    ai<sup>2</sup>-kit
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Featuring Tools</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ai2cat.html">ai2-cat Toolkit</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Workflows</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">CLL Machine Learning Potential Training Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="fep-workflow.html">FEP MLP Training Workflow</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Domain Specific Tools</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="proton-transfer.html">Proton Transfer Analysis Toolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="aos-analysis.html">Amorphous Oxides Structure Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Build-in Functionalities</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="checkpoint.html">Checkpoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="hpc-executor.html">AI<sup>2</sup>-Kit HPC Executor</a></li>
<li class="toctree-l1"><a class="reference internal" href="ase.html">ASE Toolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="dpdata.html">Dpdata Toolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="tips.html">Tips</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../notebook/ai2cat.html">AI2-Cat Calculation Notebook</a></li>



</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">中文文档</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="cll-workflow.zh.html">CLL 势函数训练工作流</a></li>
<li class="toctree-l1"><a class="reference internal" href="hpc-executor.zh.html">AI<sup>2</sup>-Kit HPC Executor</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../_api/modules.html">ai2_kit</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_api/ai2_kit.html">ai2_kit package</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_api/ai2_kit.algorithm.html">ai2_kit.algorithm package</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.algorithm.aos_analysis.html">ai2_kit.algorithm.aos_analysis module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.algorithm.proton_transfer.html">ai2_kit.algorithm.proton_transfer module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_api/ai2_kit.core.html">ai2_kit.core package</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.core.artifact.html">ai2_kit.core.artifact module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.core.checkpoint.html">ai2_kit.core.checkpoint module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.core.cmd.html">ai2_kit.core.cmd module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.core.connector.html">ai2_kit.core.connector module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.core.executor.html">ai2_kit.core.executor module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.core.future.html">ai2_kit.core.future module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.core.job.html">ai2_kit.core.job module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.core.log.html">ai2_kit.core.log module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.core.queue_system.html">ai2_kit.core.queue_system module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.core.resource_manager.html">ai2_kit.core.resource_manager module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.core.script.html">ai2_kit.core.script module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.core.util.html">ai2_kit.core.util module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_api/ai2_kit.dflow.html">ai2_kit.dflow package</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_api/ai2_kit.domain.html">ai2_kit.domain package</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.domain.asap.html">ai2_kit.domain.asap module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.domain.constant.html">ai2_kit.domain.constant module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.domain.cp2k.html">ai2_kit.domain.cp2k module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.domain.data.html">ai2_kit.domain.data module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.domain.deepmd.html">ai2_kit.domain.deepmd module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.domain.iface.html">ai2_kit.domain.iface module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.domain.lammps.html">ai2_kit.domain.lammps module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.domain.lasp.html">ai2_kit.domain.lasp module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.domain.selector.html">ai2_kit.domain.selector module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.domain.updater.html">ai2_kit.domain.updater module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.domain.util.html">ai2_kit.domain.util module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.domain.vasp.html">ai2_kit.domain.vasp module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_api/ai2_kit.feat.html">ai2_kit.feat package</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.feat.catalysis.html">ai2_kit.feat.catalysis package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_api/ai2_kit.res.html">ai2_kit.res package</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_api/ai2_kit.tool.html">ai2_kit.tool package</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.tool.ase.html">ai2_kit.tool.ase module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.tool.deepmd.html">ai2_kit.tool.deepmd module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.tool.dpdata.html">ai2_kit.tool.dpdata module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.tool.yaml.html">ai2_kit.tool.yaml module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_api/ai2_kit.workflow.html">ai2_kit.workflow package</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.workflow.cll_mlp.html">ai2_kit.workflow.cll_mlp module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_api/ai2_kit.workflow.fep_mlp.html">ai2_kit.workflow.fep_mlp module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_api/ai2_kit.main.html">ai2_kit.main module</a></li>
</ul>
</li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/chenggroup/ai2-kit" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/chenggroup/ai2-kit/issues/new?title=Issue%20on%20page%20%2Fdoc/manual/cll-workflow.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/doc/manual/cll-workflow.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>CLL Machine Learning Potential Training Workflow</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#environment-requirements">Environment Requirements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installation">Installation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usage">Usage</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preparation">Data Preparation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-file-preparation">Configuration File Preparation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#execute-workflow">Execute Workflow</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citation">Citation</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="cll-machine-learning-potential-training-workflow">
<h1>CLL Machine Learning Potential Training Workflow<a class="headerlink" href="#cll-machine-learning-potential-training-workflow" title="Permalink to this heading">#</a></h1>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ai2-kit<span class="w"> </span>workflow<span class="w"> </span>cll-mlp-training
</pre></div>
</div>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>CLL workflow is an improved version of DPGEN workflow, which is designed to meet more complex potential training requirements and sustainable code integration. CLL workflow adopts a closed-loop learning mode to automatically train MLP potential. In each iteration, the workflow uses labeled structures generated by first-principles methods to train multiple MLP models. Then, these models are used to explore new structures as training data for the next iteration. The iteration will continue until the quality of the MLP model meets the predetermined standard. The configuration of each iteration can be updated according to the training needs to further improve the training efficiency.</p>
<p><img alt="cll-mlp-diagram" src="../../_images/cll-mlp-diagram.svg" /></p>
<p>The main improvements of CLL workflow include:</p>
<ul class="simple">
<li><p>More semantic configuration system to support the selection of different software, and set different software configurations according to different systems.</p></li>
<li><p>More robust checkpoint mechanism to reduce the impact of execution interruption.</p></li>
<li><p>Support remote Python method execution to avoid unnecessary data transfer and improve the efficiency and stability of execution on HPC clusters.</p></li>
</ul>
<p>Currently, CLL workflow supports the following tools for potential training:</p>
<ul class="simple">
<li><p>Label: CP2K, VASP</p></li>
<li><p>Train: DeepMD</p></li>
<li><p>Explore: LAMMPS, LASP</p></li>
<li><p>Select: Model deviation, Distinctive structure selection</p></li>
</ul>
<p>Currently, CLL workflow submits jobs through the HPC executor provided by <code class="docutils literal notranslate"><span class="pre">ai2-kit</span></code>, which supports completing calculations in a single HPC cluster. In the future, multi-cluster scheduling and support for different workflow engines including <code class="docutils literal notranslate"><span class="pre">DFlow</span></code> will be considered according to needs.</p>
</section>
<section id="environment-requirements">
<h2>Environment Requirements<a class="headerlink" href="#environment-requirements" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>The Python version of the workflow execution environment and the HPC execution environment need to be consistent, otherwise there will be problems with remote execution.</p></li>
<li><p>The HPC execution environment needs to install <code class="docutils literal notranslate"><span class="pre">ai2-kit</span></code>. Generally speaking, the <code class="docutils literal notranslate"><span class="pre">ai2-kit</span></code> on the HPC does not need to be strictly the same as the local <code class="docutils literal notranslate"><span class="pre">ai2-kit</span></code> version, but if the difference is too large, there may still be problems, so it is recommended to use the same version of <code class="docutils literal notranslate"><span class="pre">ai2-kit</span></code> when conditions permit.</p></li>
</ul>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this heading">#</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>-U<span class="w"> </span>ai2-kit
</pre></div>
</div>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this heading">#</a></h2>
<p>The usage of CLL workflow is demonstrated through an example.</p>
<section id="data-preparation">
<h3>Data Preparation<a class="headerlink" href="#data-preparation" title="Permalink to this heading">#</a></h3>
<p>The data required for the execution of the workflow needs to be placed on the HPC cluster node in advance. Before starting the execution of the workflow, you need to prepare the following data:</p>
<ul class="simple">
<li><p>Initial structure or initial data set for potential training</p></li>
<li><p>Initial structure for structure search</p></li>
</ul>
<p>Assuming that you already have a trajectory generated by AIMD <code class="docutils literal notranslate"><span class="pre">h2o_64.aimd.xyz</span></code>, then you can use the <a class="reference internal" href="ase.html"><span class="doc std std-doc"><code class="docutils literal notranslate"><span class="pre">ai2-kit</span> <span class="pre">tool</span> <span class="pre">ase</span></code></span></a> command line tool to prepare these data.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>-p<span class="w"> </span>data/explore

<span class="c1"># Extract training set from 0-900 frames, extract every 5 frames</span>
ai2-kit<span class="w"> </span>tool<span class="w"> </span>ase<span class="w"> </span><span class="nb">read</span><span class="w"> </span>h2o_64.aimd.xyz<span class="w"> </span>--index<span class="w"> </span><span class="s1">&#39;:900:5&#39;</span><span class="w"> </span>-<span class="w"> </span>set_cell<span class="w"> </span><span class="s2">&quot;[12.42,12.42,12.42,90,90,90]&quot;</span><span class="w"> </span>-<span class="w"> </span>write<span class="w"> </span>data/training.xyz

<span class="c1"># Extract validation set from 900- frames, extract every 5 frames</span>
ai2-kit<span class="w"> </span>tool<span class="w"> </span>ase<span class="w"> </span><span class="nb">read</span><span class="w"> </span>h2o_64.aimd.xyz<span class="w"> </span>--index<span class="w"> </span><span class="s1">&#39;900::5&#39;</span><span class="w"> </span>-<span class="w"> </span>set_cell<span class="w"> </span><span class="s2">&quot;[12.42,12.42,12.42,90,90,90]&quot;</span><span class="w"> </span>-<span class="w"> </span>write<span class="w"> </span>data/validation.xyz

<span class="c1"># Extract data for initial structure search, extract every 100 frames</span>
ai2-kit<span class="w"> </span>tool<span class="w"> </span>ase<span class="w"> </span><span class="nb">read</span><span class="w"> </span>h2o_64.aimd.xyz<span class="w"> </span>--index<span class="w"> </span><span class="s1">&#39;::100&#39;</span><span class="w"> </span>-<span class="w"> </span>set_cell<span class="w"> </span><span class="s2">&quot;[12.42,12.42,12.42,90,90,90]&quot;</span><span class="w"> </span>-<span class="w"> </span>write_each_frame<span class="w"> </span><span class="s2">&quot;./data/explore/POSCAR-{i:04d}&quot;</span><span class="w"> </span>--format<span class="w"> </span>vasp
</pre></div>
</div>
</section>
<section id="configuration-file-preparation">
<h3>Configuration File Preparation<a class="headerlink" href="#configuration-file-preparation" title="Permalink to this heading">#</a></h3>
<p>The configuration file of CLL workflow is in YAML format and supports splitting in any dimension. <code class="docutils literal notranslate"><span class="pre">ai2-kit</span></code> will automatically merge them during execution. Moderate splitting is conducive to the maintenance and reuse of configuration files. In general, we can split the configuration file into the following parts:</p>
<ul class="simple">
<li><p>artifact.yml: the data required by the workflow</p></li>
<li><p>executor.yml: the parameters of the HPC executor</p></li>
<li><p>workflow.yml: the parameters of the workflow software</p></li>
</ul>
<p>Another way to build configuration is to use the configuration file provided in <span class="xref myst">example</span> as a reference to create your own workflow. For details, please refer to the document in the example directory.</p>
<p>We start with <code class="docutils literal notranslate"><span class="pre">artifact.yml</span></code>, which is used to configure the data required by the workflow. In this example, we need to configure three datasets, which are the training dataset, the validation dataset, and the dataset for structure search. The configuration of these three datasets is as follows:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">.base_dir</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;base_dir</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/home/user01/data/</span>

<span class="nt">artifacts</span><span class="p">:</span>
<span class="w">  </span><span class="nt">h2o_64-train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="kt">!join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">*base_dir</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">training.xyz</span><span class="p p-Indicator">]</span>
<span class="w">    </span>
<span class="w">  </span><span class="nt">h2o_64-validation</span><span class="p">:</span>
<span class="w">    </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="kt">!join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">*base_dir</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">validation.xyz</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">attrs</span><span class="p">:</span>
<span class="w">      </span><span class="nt">deepmd</span><span class="p">:</span>
<span class="w">        </span><span class="nt">validation_data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">  </span><span class="c1"># Specify this dataset as the validation set, Optional</span>

<span class="w">  </span><span class="nt">h2o_64-explore</span><span class="p">:</span>
<span class="w">    </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="kt">!join</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">*base_dir</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">explore</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">includes</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">POSCAR*</span>
<span class="w">    </span><span class="nt">attrs</span><span class="p">:</span><span class="w">  </span>
<span class="w">    </span><span class="c1"># If necessary, you can specify specific software configurations for specific systems here. This example does not require this configuration, so it is empty</span>
<span class="w">      </span><span class="c1"># lammps:</span>
<span class="w">      </span><span class="c1">#   plumed_config:  !load_text plumed.in</span>
<span class="w">      </span><span class="c1"># cp2k:</span>
<span class="w">      </span><span class="c1">#   input_template: !load_text cp2k.inp</span>
</pre></div>
</div>
<p>Here we use the custom tag <code class="docutils literal notranslate"><span class="pre">!join</span></code> provided by <code class="docutils literal notranslate"><span class="pre">ai2-kit</span></code> to simplify the data configuration. For related functions, please refer to the <a class="reference internal" href="tips.html"><span class="doc std std-doc">TIPS</span></a> document.</p>
<p>Next, we configure the <code class="docutils literal notranslate"><span class="pre">executor.yml</span></code> file, which is used to configure parameters related to the HPC link and the use template of the software.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">executors</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hpc-cluster01</span><span class="p">:</span>
<span class="w">    </span><span class="nt">ssh</span><span class="p">:</span>
<span class="w">      </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">user01@login-01</span><span class="w">  </span><span class="c1"># Login node</span>
<span class="w">      </span><span class="nt">gateway</span><span class="p">:</span>
<span class="w">        </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">user01@jump-host</span><span class="w">  </span><span class="c1"># Jump host (optional)</span>
<span class="w">    </span><span class="nt">queue_system</span><span class="p">:</span>
<span class="w">      </span><span class="nt">slurm</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span><span class="w">  </span><span class="c1"># Use slurm as the job scheduling system</span>

<span class="w">    </span><span class="nt">work_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/home/user01/ai2-kit/workdir</span><span class="w">  </span><span class="c1"># Working directory</span>
<span class="w">    </span><span class="nt">python_cmd</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/home/user01/libs/conda/env/py39/bin/python</span><span class="w">  </span><span class="c1"># Remote Python interpreter</span>

<span class="w">    </span><span class="nt">context</span><span class="p">:</span>
<span class="w">      </span><span class="nt">train</span><span class="p">:</span>
<span class="w">        </span><span class="nt">deepmd</span><span class="p">:</span><span class="w">  </span><span class="c1"># Configure the deepmd job submission template</span>
<span class="w">          </span><span class="nt">script_template</span><span class="p">:</span>
<span class="w">            </span><span class="nt">header</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">              </span><span class="no">#SBATCH -N 1</span>
<span class="w">              </span><span class="no">#SBATCH --ntasks-per-node=4</span>
<span class="w">              </span><span class="no">#SBATCH --job-name=deepmd</span>
<span class="w">              </span><span class="no">#SBATCH --partition=gpu3</span>
<span class="w">              </span><span class="no">#SBATCH --gres=gpu:1</span>
<span class="w">              </span><span class="no">#SBATCH --mem=8G</span>
<span class="w">            </span><span class="nt">setup</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">              </span><span class="no">set -e</span>
<span class="w">              </span><span class="no">module load deepmd/2.2</span>
<span class="w">              </span><span class="no">set +e</span>

<span class="w">      </span><span class="nt">explore</span><span class="p">:</span>
<span class="w">        </span><span class="nt">lammps</span><span class="p">:</span><span class="w">  </span><span class="c1"># Configure the lammps job submission template</span>
<span class="w">          </span><span class="nt">lammps_cmd</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lmp_mpi</span>
<span class="w">          </span><span class="nt">concurrency</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">          </span><span class="nt">script_template</span><span class="p">:</span>
<span class="w">            </span><span class="nt">header</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">              </span><span class="no">#SBATCH -N 1</span>
<span class="w">              </span><span class="no">#SBATCH --ntasks-per-node=4</span>
<span class="w">              </span><span class="no">#SBATCH --job-name=lammps</span>
<span class="w">              </span><span class="no">#SBATCH --partition=gpu3</span>
<span class="w">              </span><span class="no">#SBATCH --gres=gpu:1</span>
<span class="w">              </span><span class="no">#SBATCH --mem=24G</span>
<span class="w">            </span><span class="nt">setup</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">              </span><span class="no">set -e</span>
<span class="w">              </span><span class="no">module load deepmd/2.2</span>
<span class="w">              </span><span class="no">export OMP_NUM_THREADS=1</span>
<span class="w">              </span><span class="no">set +e</span>

<span class="w">      </span><span class="nt">label</span><span class="p">:</span>
<span class="w">        </span><span class="nt">cp2k</span><span class="p">:</span><span class="w">  </span><span class="c1"># Configure the cp2k job submission template</span>
<span class="w">          </span><span class="nt">cp2k_cmd</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mpiexec.hydra cp2k.popt</span>
<span class="w">          </span><span class="nt">concurrency</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">          </span><span class="nt">script_template</span><span class="p">:</span>
<span class="w">            </span><span class="nt">header</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">              </span><span class="no">#SBATCH -N 1</span>
<span class="w">              </span><span class="no">#SBATCH --ntasks-per-node=16</span>
<span class="w">              </span><span class="no">#SBATCH -t 12:00:00</span>
<span class="w">              </span><span class="no">#SBATCH --job-name=cp2k</span>
<span class="w">              </span><span class="no">#SBATCH --partition=c52-medium</span>
<span class="w">            </span><span class="nt">setup</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">              </span><span class="no">set -e</span>
<span class="w">              </span><span class="no">module load intel/17.5.239 mpi/intel/2017.5.239</span>
<span class="w">              </span><span class="no">module load gcc/5.5.0</span>
<span class="w">              </span><span class="no">module load cp2k/7.1</span>
<span class="w">              </span><span class="no">set +e</span>
</pre></div>
</div>
<p>Finally, the configuration of the <code class="docutils literal notranslate"><span class="pre">workflow.yml</span></code> file is the configuration of the parameters of the workflow. This file is used to configure the parameters of the workflow.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">workflow</span><span class="p">:</span>
<span class="w">  </span><span class="nt">general</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type_map</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">H</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">O</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">mass_map</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">1.008</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">15.999</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">max_iters</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class="w">  </span><span class="c1"># Specify the maximum number of iterations</span>

<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">deepmd</span><span class="p">:</span><span class="w">  </span><span class="c1"># deepmd parameter configuration</span>
<span class="w">      </span><span class="nt">model_num</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="w">      </span><span class="c1"># The data used in this example has not been labeled, so it needs to be configured here. </span>
<span class="w">      </span><span class="c1"># If there is an existing labeled deepmd/npy dataset, you can specify it here.</span>
<span class="w">      </span><span class="nt">init_dataset</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="p p-Indicator">]</span><span class="w">  </span>
<span class="w">      </span><span class="nt">input_template</span><span class="p">:</span>
<span class="w">        </span><span class="nt">model</span><span class="p">:</span>
<span class="w">          </span><span class="nt">descriptor</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">se_a</span><span class="w">  </span>
<span class="w">            </span><span class="nt">sel</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">            </span><span class="nt">rcut_smth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.5</span>
<span class="w">            </span><span class="nt">rcut</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5.0</span>
<span class="w">            </span><span class="nt">neuron</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">25</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">            </span><span class="nt">resnet_dt</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">            </span><span class="nt">axis_neuron</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">16</span>
<span class="w">            </span><span class="nt">seed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">          </span><span class="nt">fitting_net</span><span class="p">:</span>
<span class="w">            </span><span class="nt">neuron</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">240</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">240</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">240</span>
<span class="w">            </span><span class="nt">resnet_dt</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">            </span><span class="nt">seed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">        </span><span class="nt">learning_rate</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">exp</span>
<span class="w">          </span><span class="nt">start_lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.001</span>
<span class="w">          </span><span class="nt">decay_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2000</span>
<span class="w">        </span><span class="nt">loss</span><span class="p">:</span>
<span class="w">          </span><span class="nt">start_pref_e</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.02</span>
<span class="w">          </span><span class="nt">limit_pref_e</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">          </span><span class="nt">start_pref_f</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">          </span><span class="nt">limit_pref_f</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">          </span><span class="nt">start_pref_v</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">          </span><span class="nt">limit_pref_v</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">        </span><span class="nt">training</span><span class="p">:</span>
<span class="w">          </span><span class="c1">#numb_steps: 400000</span>
<span class="w">          </span><span class="nt">numb_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5000</span>
<span class="w">          </span><span class="nt">seed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">          </span><span class="nt">disp_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lcurve.out</span>
<span class="w">          </span><span class="nt">disp_freq</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">          </span><span class="nt">save_freq</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">          </span><span class="nt">save_ckpt</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">model.ckpt</span>
<span class="w">          </span><span class="nt">disp_training</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">          </span><span class="nt">time_training</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">          </span><span class="nt">profiling</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">          </span><span class="nt">profiling_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">timeline.json</span>

<span class="w">  </span><span class="nt">label</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cp2k</span><span class="p">:</span><span class="w">  </span><span class="c1"># Specify the cp2k parameter configuration</span>
<span class="w">      </span><span class="nt">limit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">      </span><span class="c1"># The data used in this example has not been labeled, so it needs to be configured here. </span>
<span class="w">      </span><span class="c1"># If there is an existing labeled dataset, this should be empty</span>
<span class="w">      </span><span class="c1"># When this configuration is empty, the workflow will automatically skip the label phase of the first iteration </span>
<span class="w">      </span><span class="c1"># and start execution from the train phase.</span>
<span class="w">      </span><span class="nt">init_system_files</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">h2o_64-train</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">h2o_64-validation</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">input_template</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">&amp;GLOBAL</span>
<span class="w">           </span><span class="no">PROJECT  DPGEN</span>
<span class="w">        </span><span class="no">&amp;END</span>
<span class="w">        </span><span class="no">&amp;FORCE_EVAL</span>
<span class="w">           </span><span class="no">&amp;DFT</span>
<span class="w">              </span><span class="no">BASIS_SET_FILE_NAME  /home/user01/data/cp2k/BASIS/BASIS_MOLOPT</span>
<span class="w">              </span><span class="no">POTENTIAL_FILE_NAME  /home/user01/data/cp2k/POTENTIAL/GTH_POTENTIALS</span>
<span class="w">              </span><span class="no">CHARGE  0</span>
<span class="w">              </span><span class="no">UKS  F</span>
<span class="w">              </span><span class="no">&amp;MGRID</span>
<span class="w">                 </span><span class="no">CUTOFF  600</span>
<span class="w">                 </span><span class="no">REL_CUTOFF  60</span>
<span class="w">                 </span><span class="no">NGRIDS  4</span>
<span class="w">              </span><span class="no">&amp;END</span>
<span class="w">              </span><span class="no">&amp;QS</span>
<span class="w">                 </span><span class="no">EPS_DEFAULT  1.0E-12</span>
<span class="w">              </span><span class="no">&amp;END</span>
<span class="w">              </span><span class="no">&amp;SCF</span>
<span class="w">                 </span><span class="no">SCF_GUESS  RESTART</span>
<span class="w">                 </span><span class="no">EPS_SCF  3.0E-7</span>
<span class="w">                 </span><span class="no">MAX_SCF  50</span>
<span class="w">                 </span><span class="no">&amp;OUTER_SCF</span>
<span class="w">                    </span><span class="no">EPS_SCF  3.0E-7</span>
<span class="w">                    </span><span class="no">MAX_SCF  10</span>
<span class="w">                 </span><span class="no">&amp;END</span>
<span class="w">                 </span><span class="no">&amp;OT</span>
<span class="w">                    </span><span class="no">MINIMIZER  DIIS</span>
<span class="w">                    </span><span class="no">PRECONDITIONER  FULL_SINGLE_INVERSE</span>
<span class="w">                    </span><span class="no">ENERGY_GAP  0.1</span>
<span class="w">                 </span><span class="no">&amp;END</span>
<span class="w">              </span><span class="no">&amp;END</span>
<span class="w">              </span><span class="no">&amp;LOCALIZE</span>
<span class="w">                 </span><span class="no">METHOD  CRAZY</span>
<span class="w">                 </span><span class="no">MAX_ITER  2000</span>
<span class="w">                 </span><span class="no">&amp;PRINT</span>
<span class="w">                    </span><span class="no">&amp;WANNIER_CENTERS</span>
<span class="w">                       </span><span class="no">IONS+CENTERS</span>
<span class="w">                       </span><span class="no">FILENAME  =64water_wannier.xyz</span>
<span class="w">                    </span><span class="no">&amp;END</span>
<span class="w">                 </span><span class="no">&amp;END</span>
<span class="w">              </span><span class="no">&amp;END</span>
<span class="w">              </span><span class="no">&amp;XC</span>
<span class="w">                 </span><span class="no">&amp;XC_FUNCTIONAL PBE</span>
<span class="w">                 </span><span class="no">&amp;END</span>
<span class="w">                 </span><span class="no">&amp;vdW_POTENTIAL</span>
<span class="w">                    </span><span class="no">DISPERSION_FUNCTIONAL  PAIR_POTENTIAL</span>
<span class="w">                    </span><span class="no">&amp;PAIR_POTENTIAL</span>
<span class="w">                       </span><span class="no">TYPE  DFTD3</span>
<span class="w">                       </span><span class="no">PARAMETER_FILE_NAME  dftd3.dat</span>
<span class="w">                       </span><span class="no">REFERENCE_FUNCTIONAL  PBE</span>
<span class="w">                    </span><span class="no">&amp;END</span>
<span class="w">                 </span><span class="no">&amp;END</span>
<span class="w">              </span><span class="no">&amp;END</span>
<span class="w">           </span><span class="no">&amp;END</span>
<span class="w">           </span><span class="no">&amp;SUBSYS</span>
<span class="w">              </span><span class="no">@include coord_n_cell.inc</span>
<span class="w">              </span><span class="no">&amp;KIND O</span>
<span class="w">                 </span><span class="no">BASIS_SET  DZVP-MOLOPT-SR-GTH</span>
<span class="w">                 </span><span class="no">POTENTIAL  GTH-PBE-q6</span>
<span class="w">              </span><span class="no">&amp;END</span>
<span class="w">              </span><span class="no">&amp;KIND H</span>
<span class="w">                 </span><span class="no">BASIS_SET  DZVP-MOLOPT-SR-GTH</span>
<span class="w">                 </span><span class="no">POTENTIAL  GTH-PBE-q1</span>
<span class="w">              </span><span class="no">&amp;END</span>
<span class="w">           </span><span class="no">&amp;END</span>
<span class="w">           </span><span class="no">&amp;PRINT</span>
<span class="w">              </span><span class="no">&amp;FORCES ON</span>
<span class="w">              </span><span class="no">&amp;END</span>
<span class="w">            </span><span class="no">&amp;END</span>
<span class="w">        </span><span class="no">&amp;END</span>

<span class="w">  </span><span class="nt">explore</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lammps</span><span class="p">:</span>
<span class="w">      </span><span class="nt">timestep</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0005</span>
<span class="w">      </span><span class="nt">sample_freq</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">      </span><span class="nt">nsteps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2000</span>
<span class="w">      </span><span class="nt">ensemble</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvt</span>

<span class="w">      </span><span class="nt">template_vars</span><span class="p">:</span>
<span class="w">        </span><span class="nt">POST_INIT</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">neighbor 1.0 bin</span>
<span class="w">          </span><span class="no">box      tilt large</span>

<span class="w">        </span><span class="nt">POST_READ_DATA</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">change_box all triclinic</span>

<span class="w">      </span><span class="nt">system_files</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">h2o-64-explore</span><span class="w"> </span><span class="p p-Indicator">]</span>

<span class="w">      </span><span class="nt">explore_vars</span><span class="p">:</span>
<span class="w">        </span><span class="nt">TEMP</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">330</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">430</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">530</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">PRES</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">TAU_T</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.1</span><span class="w">  </span><span class="c1"># Optional</span>
<span class="w">        </span><span class="nt">TAU_P</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.5</span><span class="w">  </span><span class="c1"># Optional</span>

<span class="w">  </span><span class="nt">select</span><span class="p">:</span>
<span class="w">    </span><span class="nt">model_devi</span><span class="p">:</span>
<span class="w">        </span><span class="nt">f_trust_lo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.4</span>
<span class="w">        </span><span class="nt">f_trust_hi</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.6</span>

<span class="w">  </span><span class="nt">update</span><span class="p">:</span>
<span class="w">    </span><span class="nt">walkthrough</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># You can specify the parameter configuration to be used from the second iteration and beyond here</span>
<span class="w">      </span><span class="c1"># The parameters configured here will override any configuration in the workflow section, </span>
<span class="w">      </span><span class="c1"># and can be adjusted according to the training strategy</span>
<span class="w">      </span><span class="nt">table</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">train</span><span class="p">:</span><span class="w">  </span><span class="c1"># The training steps are 10000 in the second iteration</span>
<span class="w">            </span><span class="nt">deepmd</span><span class="p">:</span>
<span class="w">              </span><span class="nt">input_template</span><span class="p">:</span>
<span class="w">                </span><span class="nt">training</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">numb_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10000</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">train</span><span class="p">:</span><span class="w">  </span><span class="c1"># The training steps are 20000 in the third iteration</span>
<span class="w">            </span><span class="nt">deepmd</span><span class="p">:</span>
<span class="w">              </span><span class="nt">input_template</span><span class="p">:</span>
<span class="w">                </span><span class="nt">training</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">numb_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20000</span>
</pre></div>
</div>
</section>
<section id="execute-workflow">
<h3>Execute Workflow<a class="headerlink" href="#execute-workflow" title="Permalink to this heading">#</a></h3>
<p>After completing the configuration, you can start the execution of the workflow</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ai2-kit<span class="w"> </span>workflow<span class="w"> </span>cll-mlp-training<span class="w"> </span>*.yml<span class="w"> </span>--executor<span class="w"> </span>hpc-cluster01<span class="w"> </span>--path-prefix<span class="w"> </span>h2o_64-run-01<span class="w"> </span>--checkpoint<span class="w"> </span>run-01.ckpt
</pre></div>
</div>
<p>In the above parameters,</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">*.yml</span></code> is used to specify the configuration file, you can specify multiple configuration files, <code class="docutils literal notranslate"><span class="pre">ai2-kit</span></code> will automatically merge them, <code class="docutils literal notranslate"><span class="pre">*</span></code> wildcard is used here;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--executor</span> <span class="pre">hpc-cluster01</span></code> is used to specify the HPC executor to use. Here, the <code class="docutils literal notranslate"><span class="pre">hpc-cluster01</span></code> executor configured in the previous section is used;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--path-prefix</span> <span class="pre">h2o_64-run-01</span></code> specifies the remote working directory, which will create a <code class="docutils literal notranslate"><span class="pre">h2o_64-run-01</span></code> directory under <code class="docutils literal notranslate"><span class="pre">work_dir</span></code> to store the execution results of the workflow;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--checkpoint</span> <span class="pre">run-01.cpkt</span></code> will generate a checkpoint file locally to save the execution status of the workflow, so as to resume execution after the execution is interrupted.</p></li>
</ul>
</section>
</section>
<section id="citation">
<h2>Citation<a class="headerlink" href="#citation" title="Permalink to this heading">#</a></h2>
<p>If you use this workflow with LASP in your research, please cite the following papers:</p>
<blockquote>
<div><p>Yu-Xin Guo, Yong-Bin Zhuang, Jueli Shi, Jun Cheng; ChecMatE: A workflow package to automatically generate machine learning potentials and phase diagrams for semiconductor alloys. J. Chem. Phys. 7 September 2023; 159 (9): 094801. <a class="reference external" href="https://doi.org/10.1063/5.0166858">https://doi.org/10.1063/5.0166858</a>
Huang, S., Shang, C., Kang, P., Zhang, X. &amp; Liu, Z. LASP: Fast global potential energy surface exploration. Wiley Interdiscip Rev Comput Mol Sci 9, (2019). <a class="reference external" href="https://doi.org/10.1002/wcms.1415">https://doi.org/10.1002/wcms.1415</a></p>
</div></blockquote>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./doc/manual"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="ai2cat.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">ai2-cat Toolkit</p>
      </div>
    </a>
    <a class="right-next"
       href="fep-workflow.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">FEP MLP Training Workflow</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#environment-requirements">Environment Requirements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installation">Installation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usage">Usage</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preparation">Data Preparation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-file-preparation">Configuration File Preparation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#execute-workflow">Execute Workflow</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citation">Citation</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By weihong.xu
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>